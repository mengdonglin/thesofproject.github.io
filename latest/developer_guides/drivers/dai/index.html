

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>DAI Drivers &mdash; SOF Project 0.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/sof-favicon-16x16.png"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/sof-custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Unit Tests" href="../../unit_tests.html" />
    <link rel="prev" title="DMA Drivers" href="../dma/index.html" /> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> SOF Project
          

          
            
            <img src="../../../_static/logo_sof_white_200w.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/index.html">Introduction to the SOF Project</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/index.html#components">Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/index.html#sof-architecture">SOF Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/index.html#sof-driver-architecture">SOF Driver Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/index.html#faq">FAQ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/index.html">Getting Started Guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../getting_started/index.html#building-sof">Building SOF</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../getting_started/build-guide/build-from-scratch.html">Build SOF from scratch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../getting_started/build-guide/build-from-scratch.html#build-sof-binaries">Build SOF binaries</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../getting_started/build-guide/build-from-scratch.html#build-linux-kernel">Build Linux kernel</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../getting_started/build-guide/build-with-docker.html">Build SOF with Docker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../getting_started/build-guide/build-with-docker.html#set-up-docker">Set up Docker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../getting_started/build-guide/build-with-docker.html#id1">Build with Docker</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../getting_started/index.html#setting-up-sof-on-hardware">Setting up SOF on hardware</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../getting_started/setup/setup_minnowboard_turbot.html">Set up SOF on Minnowboard Turbot</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../getting_started/setup/setup_minnowboard_turbot.html#minnowboard-resources">Minnowboard resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../getting_started/setup/setup_minnowboard_turbot.html#development">Development</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../getting_started/setup/setup_up_2_board.html">Set up SOF on Up Squared board with Hifiberry DAC+ (STD)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../getting_started/setup/setup_up_2_board.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../getting_started/setup/setup_up_2_board.html#setup-instructions">Setup Instructions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../getting_started/setup/setup_ktest_environment.html">Set up a Ktest-based environment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../getting_started/setup/setup_ktest_environment.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../getting_started/setup/setup_ktest_environment.html#prerequisites-on-the-target-device">Prerequisites on the target device</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../getting_started/setup/setup_ktest_environment.html#configure-ssh-without-password">Configure SSH without password</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../getting_started/setup/setup_ktest_environment.html#create-a-linux-development-environment">Create a linux development environment</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../getting_started/index.html#other-guides">Other guides</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../getting_started/cavs-boot/index.html">Booting up CAVS ADSP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../getting_started/cavs-boot/cavs-dsp-boot-overview.html">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../getting_started/cavs-boot/apollolake/index.html">Apollolake Boot Process</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../platforms/index.html">Supported Platforms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../platforms/intel-cavs/index.html">Intel CAVS Platforms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../platforms/intel-cavs/apollolake/index.html">Intel Apollo Lake</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../platforms/intel-cavs/apollolake/apl-memory.html">APL Memory</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../platforms/intel-cavs/cannonlake/index.html">Intel Cannon Lake</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../platforms/intel-cavs/cannonlake/cnl-memory.html">CNL Memory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../platforms/intel-cavs/cannonlake/cnl-config.html">CNL Configuration</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Developer Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../porting.html">Porting Guides</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../porting.html#architecture-porting-guide">Architecture Porting Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../porting.html#platform-porting-guide">Platform Porting Guide</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Drivers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../dma/index.html">DMA Drivers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dma/index.html#intro">Intro</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dma/index.html#programming-flows">Programming Flows</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dma/index.html#using-dma-driver-api">Using DMA Driver API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dma/index.html#supported-devices">Supported Devices</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">DAI Drivers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#intro">Intro</a></li>
<li class="toctree-l4"><a class="reference internal" href="#programming-flows">Programming Flows</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-dai-driver-api">Using DAI Driver API</a></li>
<li class="toctree-l4"><a class="reference internal" href="#supported-devices">Supported Devices</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../unit_tests.html">Unit Tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../unit_tests.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../unit_tests.html#enabling-unit-tests">Enabling unit tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../unit_tests.html#example-running-tests-for-apl">Example: Running tests for APL</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../unit_tests.html#preparing-cmocka-package">Preparing cmocka package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../unit_tests.html#wrapping-objects-for-unit-tests">Wrapping objects for unit tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../unit_tests.html#notes">Notes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howtos/index.html">How-Tos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../howtos/index.html#technical-notes">Technical Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../howtos/tech/placeholder.html">Work in Progress</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../howtos/index.html#process-notes">Process Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../howtos/process/docbuild.html">SOF documentation generation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../howtos/process/docbuild.html#documentation-overview">Documentation overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../howtos/process/docbuild.html#set-up-the-documentation-working-folders">Set up the documentation working folders</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../howtos/process/docbuild.html#installing-the-documentation-tools">Installing the documentation tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../howtos/process/docbuild.html#documentation-presentation-theme">Documentation presentation theme</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../howtos/process/docbuild.html#running-the-documentation-processors">Running the documentation processors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../howtos/process/docbuild.html#publishing-content">Publishing content</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../contribute/index.html">Contributing to the Project</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../contribute/contribute_guidelines.html">Contribution Guidelines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../contribute/contribute_guidelines.html#licensing">Licensing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../contribute/contribute_guidelines.html#developer-certification-of-origin-dco">Developer Certification of Origin (DCO)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../contribute/contribute_guidelines.html#dco-sign-off-methods">DCO Sign-Off Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../contribute/contribute_guidelines.html#prerequisites">Prerequisites</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../contribute/doc_guidelines.html">Documentation Guidelines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../contribute/doc_guidelines.html#headings">Headings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../contribute/doc_guidelines.html#content-highlighting">Content Highlighting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../contribute/doc_guidelines.html#lists">Lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../contribute/doc_guidelines.html#multi-column-lists">Multi-column lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../contribute/doc_guidelines.html#file-names-and-commands">File names and Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../contribute/doc_guidelines.html#internal-cross-reference-linking">Internal Cross-Reference Linking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../contribute/doc_guidelines.html#non-ascii-characters">Non-ASCII Characters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../contribute/doc_guidelines.html#code-and-command-examples">Code and Command Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../contribute/doc_guidelines.html#tabs-spaces-and-indenting">Tabs, spaces, and indenting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../contribute/dox-source-code.html">Documenting the Source Code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../contribute/dox-source-code.html#basic-rules">Basic Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../contribute/dox-source-code.html#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/dma-drivers-api.html">DMA Drivers API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/dai-drivers-api.html">DAI Drivers API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/platform-api.html">Platform API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/uapi.html">uAPI</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">SOF Project</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Developer Guides</a> &raquo;</li>
        
          <li><a href="../index.html">Drivers</a> &raquo;</li>
        
      <li>DAI Drivers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dai-drivers">
<span id="id1"></span><h1>DAI Drivers<a class="headerlink" href="#dai-drivers" title="Permalink to this headline">¶</a></h1>
<p>For the documentation of support devices refer to
<a class="reference internal" href="#dai-drivers-supported-devices"><span class="std std-ref">Supported Devices</span></a>.</p>
<div class="section" id="intro">
<h2>Intro<a class="headerlink" href="#intro" title="Permalink to this headline">¶</a></h2>
<p>DAI drivers provide access to the Digital Audio Interfaces supported by
the platform.</p>
<div class="figure" id="id2">
<p class="plantuml">
<object data="../../../_images/plantuml-7dfe138a69ab0fb2e46f8680028afb9be0c243a0.svg" type="image/svg+xml" style="width:712px;height:453px;">
<img src="../../../_images/plantuml-7dfe138a69ab0fb2e46f8680028afb9be0c243a0.png" alt="class dai {
   struct dai *dai_get(uint32_t type, uint32_t index)
}
hide dai attributes

class dai_ops {
   set_config()
   trigger()
   pm_context_restore()
   pm_context_store()
   probe()
   set_loopback_mode()
}
hide dai_ops attributes

class &quot;struct dai&quot; as s_dai {
   type : uint32_t
   index : uint32_t
   plat_data : dai_plat_data
   ops : const dai_ops *
   private : void *
}
hide s_dai methods

class &quot;struct dai_plat_data&quot; as s_dai_plat_data {
   base : uint32_t
   irq : uint32_t
   flags : uint32_t
   fifo : struct dai_plat_fifo_data[2]
}
hide s_dai_plat_data methods

class &quot;struct dai_plat_fifo_data&quot; as s_dai_plat_fifo_data {
   offset : uint32_t
   width : uint32_t
   depth : uint32_t
   watermark : uint32_t
   handshake : uint32_t
}
hide s_dai_plat_fifo_data methods

dai_ops - s_dai
s_dai -- s_dai_plat_data
s_dai_plat_data -- s_dai_plat_fifo_data
s_dai &lt;- dai : provides
" />

</object></p>
<p class="caption"><span class="caption-number">Figure 12 </span><span class="caption-text">DAI Driver API</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="programming-flows">
<h2>Programming Flows<a class="headerlink" href="#programming-flows" title="Permalink to this headline">¶</a></h2>
<div class="section" id="dai-initialization">
<h3>DAI Initialization<a class="headerlink" href="#dai-initialization" title="Permalink to this headline">¶</a></h3>
<p>When ADSP enters D0, the dai instances are probed by calling <code class="docutils literal notranslate"><span class="pre">dai_probe()</span></code>.
It is important to keep the bare minimum early initialization code inside the
probe implementation, with no power impact. Defer actions such as clock ungating until the device is requested by the client for use.</p>
</div>
<div class="section" id="configuration-commands">
<h3>Configuration &amp; Commands<a class="headerlink" href="#configuration-commands" title="Permalink to this headline">¶</a></h3>
<p>Before the dai client starts the device, it is configured with parameters
from the IPC command.</p>
<p class="plantuml">
<object data="../../../_images/plantuml-35dda0f24e8270f2693acf35316fc632cfe832ca.svg" type="image/svg+xml" style="width:799px;height:369px;">
<img src="../../../_images/plantuml-35dda0f24e8270f2693acf35316fc632cfe832ca.png" alt="participant host as &quot;Host&quot;
participant ipc
participant platform
participant dai_comp as &quot;audio/dai&quot;
participant dai
participant dai_hw

host -&gt; ipc : ipc_dai_config(config)
   activate ipc

   ipc -&gt; platform : dai_get(config-&gt;type, config-&gt;id)
      activate platform
   ipc &lt;-- platform : dai ptr
   deactivate platform

   ipc -&gt; dai : dai_set_config(config)
      activate dai
      dai -&gt; dai_hw : setup
      activate dai_hw
   ipc &lt;-- dai
   deactivate dai

host &lt;-- ipc
deactivate ipc

host -&gt; dai_comp : dai_comp_trigger(cmd)
   note right: Full call path includes parent pipeline
   activate dai_comp
   dai_comp -&gt; dai : dai_trigger(cmd)
      activate dai
      dai -&gt; dai_hw : update
   dai_comp &lt;-- dai
host &lt;-- dai_comp
" />

</object></p>
</div>
</div>
<div class="section" id="using-dai-driver-api">
<h2>Using DAI Driver API<a class="headerlink" href="#using-dai-driver-api" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="../../../api/dai-drivers-api.html#dai-drivers-api"><span class="std std-ref">DAI Drivers API</span></a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The API is accessed through a common structure; however, an
implementation may keep some specific private data attached to the
<code class="docutils literal notranslate"><span class="pre">dai.private</span></code> pointer.</p>
</div>
</div>
<div class="section" id="supported-devices">
<span id="dai-drivers-supported-devices"></span><h2>Supported Devices<a class="headerlink" href="#supported-devices" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Throughout this tutorial, we reference your website name as &lt;your_website&gt;.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, SOF Project.
      Last updated on Sep 10, 2018.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>